<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Калькулятор розрахунку закупівлі миючих засобів</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light blue-gray background */
        }
        .container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        input[type="number"], input[type="text"] {
            padding: 0.75rem;
            border: 1px solid #cbd5e0; /* Gray-300 */
            border-radius: 8px;
            width: 100%;
            box-sizing: border-box;
            font-size: 1rem;
            transition: border-color 0.2s;
        }
        input[type="number"]:focus, input[type="text"]:focus {
            outline: none;
            border-color: #6366f1; /* Indigo-500 */
            box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2);
        }
        .button {
            padding: 0.8rem 1.5rem;
            background-color: #4f46e5; /* Indigo-600 */
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease;
        }
        .button:hover {
            background-color: #4338ca; /* Indigo-700 */
            transform: translateY(-1px);
        }
        .button:active {
            transform: translateY(0);
        }
        .result-box {
            background-color: #e0e7ff; /* Indigo-100 */
            padding: 1rem;
            border-radius: 8px;
            /* text-align: center; */
            font-size: 1.1rem;
            font-weight: 600;
            color: #1e3a8a; /* Blue-900 */
        }
        .result-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }
        .result-item span:first-child {
            font-weight: normal;
            color: #374151; /* Gray-700 */
        }
    </style>
</head>
<body class="p-4">
    <div class="container">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">Калькулятор розрахунку закупівлі миючих засобів</h1>
        <p class="text-center text-gray-600 mb-8">Будь ласка, введіть необхідні дані для розрахунку місячної потреби в засобах для прибирання.</p>

        <div class="space-y-6">
            <!-- Input Fields -->
            <div class="p-6 bg-white rounded-lg shadow-md border border-gray-200">
                <h2 class="text-xl font-semibold text-gray-700 mb-4">Введення даних</h2>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="area_m2" class="block text-gray-700 text-sm font-medium mb-2">Площа приміщення (м²)</label>
                        <input type="number" id="area_m2" min="1" value="500" class="focus:border-indigo-500">
                        <p class="text-xs text-gray-500 mt-1">Загальна площа, що прибирається.</p>
                    </div>
                    <div>
                        <label for="active_days_per_month" class="block text-gray-700 text-sm font-medium mb-2">Кількість активних днів на місяць</label>
                        <input type="number" id="active_days_per_month" min="1" value="20" class="focus:border-indigo-500">
                        <p class="text-xs text-gray-500 mt-1">Кількість днів, коли проводиться щоденне прибирання (2 рази на день).</p>
                    </div>
                </div>
            </div>
            <div class="flex flex-col sm:flex-row gap-4">
                <button onclick="calculateSupplies()" class="button flex-1">Розрахувати потребу</button>
                <button onclick="exportSuppliesToExcel()" class="button flex-1 bg-green-600 hover:bg-green-700">Вивантажити в Excel</button>
            </div>

            <!-- Results Display -->
            <div id="results" class="result-box hidden">
                <h2 class="text-lg font-bold text-gray-800 mb-4 text-center">Місячна потреба:</h2>
                <div class="space-y-2">
                    <div class="result-item">
                        <span>Миючий засіб (щоденні прибирання + підвіконня):</span> <span id="daily_detergent_kg">0 кг/міс</span>
                    </div>
                    <div class="result-item">
                        <span>Дезінфікуючий засіб (щоденні прибирання):</span> <span id="daily_disinfectant_l">0 л/міс</span>
                    </div>
                    <div class="result-item">
                        <span>Ганчірки (щоденні прибирання):</span> <span id="daily_cloths">0 шт/міс</span>
                    </div>
                    <div class="result-item">
                        <span>Миючий засіб (генеральне прибирання):</span> <span id="general_detergent_kg">0 кг/міс</span>
                    </div>
                    <div class="result-item">
                        <span>Дезінфікуючий засіб (генеральне прибирання):</span> <span id="general_disinfectant_l">0 л/міс</span>
                    </div>
                     <div class="result-item">
                        <span>Засіб для миття душових (щотижнево):</span> <span id="shower_cleaner_l">0 л/міс</span>
                    </div>
                    <div class="result-item">
                        <span>Засіб для миття іграшок (щотижнево):</span> <span id="toy_cleaner_l">0 л/міс</span>
                    </div>
                    <div class="result-item">
                        <span>Засіб для миття посуду:</span> <span id="dish_soap_l">0 л/міс</span>
                    </div>
                    <div class="result-item">
                        <span>Засіб для чищення туалетів:</span> <span id="toilet_cleaner_l">0 л/міс</span>
                    </div>
                    <div class="result-item">
                        <span>Туалетний папір:</span> <span id="toilet_paper_rolls">0 рулонів/міс</span>
                    </div>
                    <div class="result-item">
                        <span>Набори мила:</span> <span id="soap_packs">0 наборів/міс</span>
                    </div>
                    <div class="result-item">
                        <span>Одноразові стаканчики:</span> <span id="cups">0 шт/міс</span>
                    </div>
                    <div class="result-item">
                        <span>Зміна мопа:</span> <span id="mop_change_freq">раз у квартал</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Constants for calculations
        const water_per_100m2 = 25;           // liters
        const detergent_per_l_water = 5;      // grams per liter of water
        const detergent_reserve_percentage = 0.1; // 10% reserve

        const cloths_per_cleaning = 3;       // cloths per regular cleaning
        const disinfectant_l_per_cleaning = 0.1; // liters per regular cleaning

        // New constants for general cleaning
        const general_cleaning_detergent_kg = 0.5; // kg for one general cleaning
        const general_cleaning_disinfectant_l = 0.2; // liters for one general cleaning

        // New constants for weekly items (4 weeks per month)
        const shower_cleaner_l_per_week = 0.1; // liters per weekly shower cleaning
        const toy_cleaner_l_per_week = 0.05;  // liters per weekly toy cleaning
        // Fixed monthly items
        const dish_soap_l_per_month_fixed = 1.5;
        const toilet_cleaner_l_per_month_fixed = 2;
        const toilet_paper_rolls_per_month_fixed = 10;
        const soap_packs_per_month_fixed = 4;
        const cups_fixed_per_child_per_day = 6; // 6 children * 20 days (this is per active day, so total daily use)

        // Global variables to store calculated values for export
        let globalCalculatedSupplies = {};

        function calculateSupplies() {
            const area_m2 = parseFloat(document.getElementById('area_m2').value) || 0;
            const active_days_per_month = parseFloat(document.getElementById('active_days_per_month').value) || 0;

            // Calculate total daily cleaning occurrences
            const daily_cleaning_occurrences = active_days_per_month * 2; // 2 times per day

            // --- Daily Cleaning Calculations (including windowsills) ---
            const water_volume_per_daily_occurrence = (area_m2 / 100) * water_per_100m2; // water per single daily cleaning pass

            const daily_detergent_g = water_volume_per_daily_occurrence * detergent_per_l_water * daily_cleaning_occurrences;
            const total_daily_detergent_kg = (daily_detergent_g * (1 + detergent_reserve_percentage)) / 1000;

            const total_daily_disinfectant = disinfectant_l_per_cleaning * daily_cleaning_occurrences;
            const total_daily_cloths = cloths_per_cleaning * daily_cleaning_occurrences;
            const total_daily_cups = cups_fixed_per_child_per_day * daily_cleaning_occurrences; // Total cups for all children each day

            // --- Weekly Cleaning Calculations (for 4 weeks in a month) ---
            const total_shower_cleaner_l = shower_cleaner_l_per_week * 4;
            const total_toy_cleaner_l = toy_cleaner_l_per_week * 4;

            // Store results globally
            globalCalculatedSupplies = {
                daily_detergent_kg: total_daily_detergent_kg,
                daily_disinfectant_l: total_daily_disinfectant,
                daily_cloths: total_daily_cloths,
                general_detergent_kg: general_cleaning_detergent_kg, // 1 general cleaning per month
                general_disinfectant_l: general_cleaning_disinfectant_l, // 1 general cleaning per month
                shower_cleaner_l: total_shower_cleaner_l,
                toy_cleaner_l: total_toy_cleaner_l,
                dish_soap_l: dish_soap_l_per_month_fixed,
                toilet_cleaner_l: toilet_cleaner_l_per_month_fixed,
                toilet_paper_rolls: toilet_paper_rolls_per_month_fixed,
                soap_packs: soap_packs_per_month_fixed,
                cups: total_daily_cups,
                mop_change_freq: "раз у квартал"
            };
            // Update results on the page
            document.getElementById('daily_detergent_kg').textContent = globalCalculatedSupplies.daily_detergent_kg.toFixed(2) + ' кг/міс';
            document.getElementById('daily_disinfectant_l').textContent = globalCalculatedSupplies.daily_disinfectant_l.toFixed(1) + ' л/міс';
            document.getElementById('daily_cloths').textContent = Math.round(globalCalculatedSupplies.daily_cloths) + ' шт/міс';
            document.getElementById('general_detergent_kg').textContent = globalCalculatedSupplies.general_detergent_kg.toFixed(2) + ' кг/міс';
            document.getElementById('general_disinfectant_l').textContent = globalCalculatedSupplies.general_disinfectant_l.toFixed(1) + ' л/міс';
            document.getElementById('shower_cleaner_l').textContent = globalCalculatedSupplies.shower_cleaner_l.toFixed(1) + ' л/міс';
            document.getElementById('toy_cleaner_l').textContent = globalCalculatedSupplies.toy_cleaner_l.toFixed(1) + ' л/міс';
            document.getElementById('dish_soap_l').textContent = globalCalculatedSupplies.dish_soap_l.toFixed(1) + ' л/міс';
            document.getElementById('toilet_cleaner_l').textContent = globalCalculatedSupplies.toilet_cleaner_l.toFixed(1) + ' л/міс';
            document.getElementById('toilet_paper_rolls').textContent = Math.round(globalCalculatedSupplies.toilet_paper_rolls) + ' рулонів/міс';
            document.getElementById('soap_packs').textContent = Math.round(globalCalculatedSupplies.soap_packs) + ' наборів/міс';
            document.getElementById('cups').textContent = Math.round(globalCalculatedSupplies.cups) + ' шт/міс';
            document.getElementById('mop_change_freq').textContent = globalCalculatedSupplies.mop_change_freq;

            document.getElementById('results').classList.remove('hidden');
        }

        function exportSuppliesToExcel() {
            if (Object.keys(globalCalculatedSupplies).length === 0 || document.getElementById('results').classList.contains('hidden')) {
                 alert("Будь ласка, розрахуйте потребу перед експортом.");
                 return;
            }

            let csvContent = "data:text/csv;charset=utf-8,\uFEFF"; // \uFEFF for UTF-8 BOM

            // Headers
            csvContent += "Показник,Значення\n";

            // Inputs
            csvContent += `Площа приміщення (м²),${document.getElementById('area_m2').value}\n`;
            csvContent += `Кількість активних днів на місяць,${document.getElementById('active_days_per_month').value}\n`;
            csvContent += "\nМісячна потреба:\n"; // Separator
            // Results
            csvContent += `Миючий засіб (щоденні прибирання + підвіконня),${globalCalculatedSupplies.daily_detergent_kg.toFixed(2)} кг/міс\n`;
            csvContent += `Дезінфікуючий засіб (щоденні прибирання),${globalCalculatedSupplies.daily_disinfectant_l.toFixed(1)} л/міс\n`;
            csvContent += `Ганчірки (щоденні прибирання),${Math.round(globalCalculatedSupplies.daily_cloths)} шт/міс\n`;
            csvContent += `Миючий засіб (генеральне прибирання),${globalCalculatedSupplies.general_detergent_kg.toFixed(2)} кг/міс\n`;
            csvContent += `Дезінфікуючий засіб (генеральне прибирання),${globalCalculatedSupplies.general_disinfectant_l.toFixed(1)} л/міс\n`;
            csvContent += `Засіб для миття душових (щотижнево),${globalCalculatedSupplies.shower_cleaner_l.toFixed(1)} л/міс\n`;
            csvContent += `Засіб для миття іграшок (щотижнево),${globalCalculatedSupplies.toy_cleaner_l.toFixed(1)} л/міс\n`;
            csvContent += `Засіб для миття посуду,${globalCalculatedSupplies.dish_soap_l.toFixed(1)} л/міс\n`;
            csvContent += `Засіб для чищення туалетів,${globalCalculatedSupplies.toilet_cleaner_l.toFixed(1)} л/міс\n`;
            csvContent += `Туалетний папір,${Math.round(globalCalculatedSupplies.toilet_paper_rolls)} рулонів/міс\n`;
            csvContent += `Набори мила,${Math.round(globalCalculatedSupplies.soap_packs)} наборів/міс\n`;
            csvContent += `Одноразові стаканчики,${Math.round(globalCalculatedSupplies.cups)} шт/міс\n`;
            csvContent += `Зміна мопа,${globalCalculatedSupplies.mop_change_freq}\n`;


            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `Розрахунок_Миючих_Засобів_${new Date().toISOString().slice(0,10)}.csv`);
            document.body.appendChild(link); // Required for Firefox
            link.click();
            document.body.removeChild(link); // Clean up
        }
    </script>
</body>
</html>